<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>R_RTOS: R_RTOS_sem.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">R_RTOS
   &#160;<span id="projectnumber">0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_r___r_t_o_s__sem_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">R_RTOS_sem.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Functions for creating, initializing, maintaining and handling a task timers.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="_r___r_t_o_s__sem_8h_source.html">R_RTOS_sem.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_r___r_t_o_s__task_8h_source.html">R_RTOS_task.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_r___r_t_o_s__mem_mngr_8h_source.html">R_RTOS_memMngr.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:abc28b742f4b88a0ddaa03999ba1b1edf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_r___r_t_o_s__sem_8c.html#abc28b742f4b88a0ddaa03999ba1b1edf">os_SCHEDULE</a> (void)</td></tr>
<tr class="memdesc:abc28b742f4b88a0ddaa03999ba1b1edf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Schedules the next ready task according to its priority.  <a href="#abc28b742f4b88a0ddaa03999ba1b1edf">More...</a><br /></td></tr>
<tr class="separator:abc28b742f4b88a0ddaa03999ba1b1edf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68b38763cc121b266a792122dc60349c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_r___r_t_o_s__inc_8h.html#ae652fbd48bfccbcc4f573e8d45529404">RetCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_r___r_t_o_s__sem_8c.html#a68b38763cc121b266a792122dc60349c">sem_InitSems</a> (void)</td></tr>
<tr class="memdesc:a68b38763cc121b266a792122dc60349c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the semaphore functionality.  <a href="#a68b38763cc121b266a792122dc60349c">More...</a><br /></td></tr>
<tr class="separator:a68b38763cc121b266a792122dc60349c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62414039a6ce95e8208ebc4fe67d0610"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_r___r_t_o_s__inc_8h.html#ae652fbd48bfccbcc4f573e8d45529404">RetCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_r___r_t_o_s__sem_8c.html#a62414039a6ce95e8208ebc4fe67d0610">sem_TakeSem</a> (<a class="el" href="_r___r_t_o_s__inc_8h.html#ac82ec54129091dcecd0e68cacf585078">PTskTCB</a> const tsk, const <a class="el" href="_r___r_t_o_s__inc_8h.html#a0e91b259511e391ba8d7c6f0963c4888">SemNr</a> semNr, const <a class="el" href="_r___r_t_o_s__inc_8h.html#aed568e9fa30417e4671c4932c04bdbae">SysTicks</a> maxSysTicksToWait)</td></tr>
<tr class="memdesc:a62414039a6ce95e8208ebc4fe67d0610"><td class="mdescLeft">&#160;</td><td class="mdescRight">Attempts to take the semaphore with the given number for the specified task.  <a href="#a62414039a6ce95e8208ebc4fe67d0610">More...</a><br /></td></tr>
<tr class="separator:a62414039a6ce95e8208ebc4fe67d0610"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0aceab8b14a7e485798ac329f74b52d8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_r___r_t_o_s__inc_8h.html#ae652fbd48bfccbcc4f573e8d45529404">RetCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_r___r_t_o_s__sem_8c.html#a0aceab8b14a7e485798ac329f74b52d8">sem_GiveSem</a> (<a class="el" href="_r___r_t_o_s__inc_8h.html#ac82ec54129091dcecd0e68cacf585078">PTskTCB</a> const tsk, const <a class="el" href="_r___r_t_o_s__inc_8h.html#a0e91b259511e391ba8d7c6f0963c4888">SemNr</a> semNr)</td></tr>
<tr class="memdesc:a0aceab8b14a7e485798ac329f74b52d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Releases the semaphore with the given number.  <a href="#a0aceab8b14a7e485798ac329f74b52d8">More...</a><br /></td></tr>
<tr class="separator:a0aceab8b14a7e485798ac329f74b52d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cee1c0e25279b2f2042abcda28bf033"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_r___r_t_o_s__inc_8h.html#ae652fbd48bfccbcc4f573e8d45529404">RetCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_r___r_t_o_s__sem_8c.html#a6cee1c0e25279b2f2042abcda28bf033">sem_DeleteTskSemQ</a> (<a class="el" href="_r___r_t_o_s__inc_8h.html#ac82ec54129091dcecd0e68cacf585078">PTskTCB</a> const tsk)</td></tr>
<tr class="memdesc:a6cee1c0e25279b2f2042abcda28bf033"><td class="mdescLeft">&#160;</td><td class="mdescRight">Delete a SemLst entry from the semaphore queue.  <a href="#a6cee1c0e25279b2f2042abcda28bf033">More...</a><br /></td></tr>
<tr class="separator:a6cee1c0e25279b2f2042abcda28bf033"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:afd3a7b44a07ad502617fbc3dbe9edd2f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_r___r_t_o_s__inc_8h.html#abf73076e6fa046f3519a37e9ad34ad7d">TskTCB</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_r___r_t_o_s__sem_8c.html#afd3a7b44a07ad502617fbc3dbe9edd2f">pIDLETsk</a></td></tr>
<tr class="memdesc:afd3a7b44a07ad502617fbc3dbe9edd2f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constant pointer to the IDLE Task's <a class="el" href="structtsk_t_c_b.html" title="Task Control Block. ">tskTCB</a>.  <a href="#afd3a7b44a07ad502617fbc3dbe9edd2f">More...</a><br /></td></tr>
<tr class="separator:afd3a7b44a07ad502617fbc3dbe9edd2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa79a678b448ba335e9ea783203fed6c9"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa79a678b448ba335e9ea783203fed6c9"></a>
static <a class="el" href="_r___r_t_o_s__inc_8h.html#af4122a81b390d3c8725c7e151ecf9cfd">Sem</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_r___r_t_o_s__sem_8c.html#aa79a678b448ba335e9ea783203fed6c9">ar_Sems</a> [<a class="el" href="_r___r_t_o_s__inc_8h.html#ae9dd548797f86260b3017bbc083d3c9e">AMOUNT_OF_SEMS</a>]</td></tr>
<tr class="memdesc:aa79a678b448ba335e9ea783203fed6c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Contains all semaphores. <br /></td></tr>
<tr class="separator:aa79a678b448ba335e9ea783203fed6c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Functions for creating, initializing, maintaining and handling a task timers. </p>
<dl class="section author"><dt>Author</dt><dd>Christian Neuberger (<a href="#" onclick="location.href='mai'+'lto:'+'Neu'+'be'+'rge'+'rC'+'h50'+'34'+'4@t'+'h-'+'nue'+'rn'+'ber'+'g.'+'de'; return false;">Neube<span style="display: none;">.nosp@m.</span>rger<span style="display: none;">.nosp@m.</span>Ch503<span style="display: none;">.nosp@m.</span>44@t<span style="display: none;">.nosp@m.</span>h-nue<span style="display: none;">.nosp@m.</span>rnbe<span style="display: none;">.nosp@m.</span>rg.de</a>) </dd></dl>
<dl class="section date"><dt>Date</dt><dd>15.12.2015 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="abc28b742f4b88a0ddaa03999ba1b1edf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void os_SCHEDULE </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Schedules the next ready task according to its priority. </p>
<p>The task queue is scanned until a task ready to run is found. The queue is sorted according to the tasks' priority beforehand. </p><dl class="section post"><dt>Postcondition</dt><dd>p_nxt_tsk_tcb A pointer to the chosen task's <a class="el" href="structtsk_t_c_b.html" title="Task Control Block. ">tskTCB</a> is stored to this global variable. </dd>
<dd>
If the next task does not equal the current task a context switch is initiated by setting PendSV to pending </dd></dl>

</div>
</div>
<a class="anchor" id="a6cee1c0e25279b2f2042abcda28bf033"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_r___r_t_o_s__inc_8h.html#ae652fbd48bfccbcc4f573e8d45529404">RetCode</a> sem_DeleteTskSemQ </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_r___r_t_o_s__inc_8h.html#ac82ec54129091dcecd0e68cacf585078">PTskTCB</a> const&#160;</td>
          <td class="paramname"><em>tsk</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Delete a SemLst entry from the semaphore queue. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tsk</td><td>Task to be deleted from the semaphore's queue it is currently queued into </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Return the success of the operation </dd></dl>

</div>
</div>
<a class="anchor" id="a0aceab8b14a7e485798ac329f74b52d8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_r___r_t_o_s__inc_8h.html#ae652fbd48bfccbcc4f573e8d45529404">RetCode</a> sem_GiveSem </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_r___r_t_o_s__inc_8h.html#ac82ec54129091dcecd0e68cacf585078">PTskTCB</a> const&#160;</td>
          <td class="paramname"><em>tsk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="_r___r_t_o_s__inc_8h.html#a0e91b259511e391ba8d7c6f0963c4888">SemNr</a>&#160;</td>
          <td class="paramname"><em>semNr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Releases the semaphore with the given number. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tsk</td><td>Pointer to the task's TskTcb </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">semNr</td><td>Number of the semaphore to be released </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Return the success of the operation</dd></dl>
<p>The original priority of the task is restored. The next task in the semaphore queue (if any) is given the semaphore and set to the suspended task state. The semaphore queue is adjusted automatically. </p>

</div>
</div>
<a class="anchor" id="a68b38763cc121b266a792122dc60349c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_r___r_t_o_s__inc_8h.html#ae652fbd48bfccbcc4f573e8d45529404">RetCode</a> sem_InitSems </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the semaphore functionality. </p>
<dl class="section return"><dt>Returns</dt><dd>Return the success of the operation</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Semaphores need to be initialized before usage! Usually this takes place during initialization of the OS. </dd></dl>

</div>
</div>
<a class="anchor" id="a62414039a6ce95e8208ebc4fe67d0610"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_r___r_t_o_s__inc_8h.html#ae652fbd48bfccbcc4f573e8d45529404">RetCode</a> sem_TakeSem </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_r___r_t_o_s__inc_8h.html#ac82ec54129091dcecd0e68cacf585078">PTskTCB</a> const&#160;</td>
          <td class="paramname"><em>tsk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="_r___r_t_o_s__inc_8h.html#a0e91b259511e391ba8d7c6f0963c4888">SemNr</a>&#160;</td>
          <td class="paramname"><em>semNr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="_r___r_t_o_s__inc_8h.html#aed568e9fa30417e4671c4932c04bdbae">SysTicks</a>&#160;</td>
          <td class="paramname"><em>maxSysTicksToWait</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Attempts to take the semaphore with the given number for the specified task. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tsk</td><td>Pointer to the task's TskTcb </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">semNr</td><td>Number of the semaphore to be taken </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxSysTicksToWait</td><td>Maximum number of SysTicks to wait until the task is unblocked. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Return the success of the operation</dd></dl>
<p>If the semaphore is not yet taken, the task requesting this semaphore is now occupying the semaphore. The execution of the task is continued.</p>
<p>If the semaphore is already taken when the task tries to take it, the task is queued into the semaphore queue. If its priority is higher than the task's occupying the semaphore priority, the task's occupying the semaphore priority is adjusted. =&gt; priority inheritance.</p>
<p>The mechanism ensures that no lower priority task, whose priority is still higher than the task's occupying the semaphore priority, is executed as long as the high priority task is waiting on the semaphore. Further tasks trying to take the semaphore are queued into the semaphore list according to their priority. </p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="afd3a7b44a07ad502617fbc3dbe9edd2f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_r___r_t_o_s__inc_8h.html#abf73076e6fa046f3519a37e9ad34ad7d">TskTCB</a>* pIDLETsk</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constant pointer to the IDLE Task's <a class="el" href="structtsk_t_c_b.html" title="Task Control Block. ">tskTCB</a>. </p>
<p>Since the IDLE Task is not allocated dynamically its location in the memory will not change during runtime. This Pointer is used to always reference the IDLE Task and thus the start of the list containing all tasks in the System.</p>
<p>Initialized to the address of the IDLE Task's <a class="el" href="structtsk_t_c_b.html" title="Task Control Block. ">tskTCB</a>. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_74389ed8173ad57b461b9d623a1f3867.html">Source</a></li><li class="navelem"><a class="el" href="_r___r_t_o_s__sem_8c.html">R_RTOS_sem.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
